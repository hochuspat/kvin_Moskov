{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames, hasReactNode } from \"@vkontakte/vkjs\";\nimport { useEnsuredControl } from \"../../hooks/useEnsuredControl\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { Platform } from \"../../lib/platform\";\nimport { Headline } from \"../Typography/Headline/Headline\";\nimport { Title } from \"../Typography/Title/Title\";\n\nvar WriteBarTypography = function (props) {\n  var platform = usePlatform();\n\n  if (platform === Platform.IOS) {\n    return /*#__PURE__*/React.createElement(Title, _object_spread_props(_object_spread({}, props), {\n      level: \"3\",\n      weight: \"3\"\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(Headline, props);\n};\n/**\n * @see https://vkcom.github.io/VKUI/#/WriteBar\n */\n\n\nexport var WriteBar = function (_param) {\n  var className = _param.className,\n      style = _param.style,\n      before = _param.before,\n      inlineAfter = _param.inlineAfter,\n      after = _param.after,\n      getRootRef = _param.getRootRef,\n      getRef = _param.getRef,\n      onHeightChange = _param.onHeightChange,\n      _param_shadow = _param.shadow,\n      shadow = _param_shadow === void 0 ? false : _param_shadow,\n      defaultValue = _param.defaultValue,\n      restProps = _object_without_properties(_param, [\"className\", \"style\", \"before\", \"inlineAfter\", \"after\", \"getRootRef\", \"getRef\", \"onHeightChange\", \"shadow\", \"defaultValue\"]);\n\n  var platform = usePlatform();\n\n  var _useEnsuredControl = _sliced_to_array(useEnsuredControl(_object_spread({\n    defaultValue: defaultValue\n  }, restProps)), 2),\n      value = _useEnsuredControl[0],\n      onChange = _useEnsuredControl[1];\n\n  var textareaRef = useExternRef(getRef);\n  var currentScrollHeight = React.useRef();\n  var resize = React.useCallback(function () {\n    var textareaEl = textareaRef.current;\n\n    if (!textareaEl) {\n      return;\n    }\n\n    if (textareaEl.offsetParent) {\n      textareaEl.style.height = \"\";\n      textareaEl.style.height = \"\".concat(textareaEl.scrollHeight, \"px\");\n\n      if (textareaEl.scrollHeight !== currentScrollHeight.current && onHeightChange) {\n        onHeightChange();\n        currentScrollHeight.current = textareaEl.scrollHeight;\n      }\n    }\n  }, [onHeightChange, textareaRef]);\n  React.useEffect(resize, [resize, value, platform]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: getRootRef,\n    className: classNames(\"vkuiWriteBar\", platform === Platform.IOS && \"vkuiWriteBar--ios\", shadow && \"vkuiWriteBar--shadow\", className),\n    style: style\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__form\"\n  }, hasReactNode(before) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__before\"\n  }, before), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__formIn\"\n  }, /*#__PURE__*/React.createElement(WriteBarTypography, _object_spread_props(_object_spread({}, restProps), {\n    Component: \"textarea\",\n    className: \"vkuiWriteBar__textarea\",\n    onChange: onChange,\n    getRootRef: textareaRef,\n    value: value\n  })), hasReactNode(inlineAfter) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__inlineAfter\"\n  }, inlineAfter)), hasReactNode(after) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__after\"\n  }, after)));\n};","map":{"version":3,"mappings":"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","names":["React","classNames","hasReactNode","useEnsuredControl","useExternRef","usePlatform","Platform","Headline","Title","WriteBarTypography","props","platform","IOS","level","weight","WriteBar","className","style","before","inlineAfter","after","getRootRef","getRef","onHeightChange","shadow","_param_shadow","defaultValue","restProps","_object_spread","value","onChange","textareaRef","currentScrollHeight","useRef","resize","useCallback","textareaEl","current","offsetParent","height","concat","scrollHeight","useEffect","div","ref","Component"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkui\\src\\components\\WriteBar\\WriteBar.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { useEnsuredControl } from '../../hooks/useEnsuredControl';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { Platform } from '../../lib/platform';\nimport { HasRef, HasRootRef } from '../../types';\nimport { Headline } from '../Typography/Headline/Headline';\nimport { Title } from '../Typography/Title/Title';\nimport { TypographyProps } from '../Typography/Typography';\nimport styles from './WriteBar.module.css';\n\nexport interface WriteBarProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLTextAreaElement> {\n  /**\n   * Содержимое, отображаемое слева от поля ввода.\n   */\n  before?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое поверх поля ввода (актуально для iOS)\n   */\n  inlineAfter?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое справа от поля ввода\n   */\n  after?: React.ReactNode;\n  /**\n   * Вызывается при смене высоты поля ввода\n   */\n  onHeightChange?: VoidFunction;\n  /**\n   * Добавляет тень вокруг поля ввода\n   */\n  shadow?: boolean;\n\n  children?: never;\n}\n\nconst WriteBarTypography = (props: TypographyProps) => {\n  const platform = usePlatform();\n\n  if (platform === Platform.IOS) {\n    return <Title {...props} level=\"3\" weight=\"3\" />;\n  }\n\n  return <Headline {...props} />;\n};\n\n/**\n * @see https://vkcom.github.io/VKUI/#/WriteBar\n */\nexport const WriteBar = ({\n  className,\n  style,\n  before,\n  inlineAfter,\n  after,\n  getRootRef,\n  getRef,\n  onHeightChange,\n  shadow = false,\n  defaultValue,\n  ...restProps\n}: WriteBarProps) => {\n  const platform = usePlatform();\n\n  const [value, onChange] = useEnsuredControl({\n    defaultValue,\n    ...restProps,\n  });\n\n  const textareaRef = useExternRef(getRef);\n  const currentScrollHeight = React.useRef<number>();\n\n  const resize = React.useCallback(() => {\n    const textareaEl = textareaRef.current;\n    if (!textareaEl) {\n      return;\n    }\n\n    if (textareaEl.offsetParent) {\n      textareaEl.style.height = '';\n      textareaEl.style.height = `${textareaEl.scrollHeight}px`;\n\n      if (textareaEl.scrollHeight !== currentScrollHeight.current && onHeightChange) {\n        onHeightChange();\n        currentScrollHeight.current = textareaEl.scrollHeight;\n      }\n    }\n  }, [onHeightChange, textareaRef]);\n\n  React.useEffect(resize, [resize, value, platform]);\n\n  return (\n    <div\n      ref={getRootRef}\n      className={classNames(\n        styles['WriteBar'],\n        platform === Platform.IOS && styles['WriteBar--ios'],\n        shadow && styles['WriteBar--shadow'],\n        className,\n      )}\n      style={style}\n    >\n      <div className={styles['WriteBar__form']}>\n        {hasReactNode(before) && <div className={styles['WriteBar__before']}>{before}</div>}\n\n        <div className={styles['WriteBar__formIn']}>\n          <WriteBarTypography\n            {...restProps}\n            Component=\"textarea\"\n            className={styles['WriteBar__textarea']}\n            onChange={onChange}\n            getRootRef={textareaRef}\n            value={value}\n          />\n          {hasReactNode(inlineAfter) && (\n            <div className={styles['WriteBar__inlineAfter']}>{inlineAfter}</div>\n          )}\n        </div>\n\n        {hasReactNode(after) && <div className={styles['WriteBar__after']}>{after}</div>}\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}