{"ast":null,"code":"import { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport vkBridge from \"@vkontakte/vk-bridge\";\nimport { useIsomorphicLayoutEffect } from \"../lib/useIsomorphicLayoutEffect\";\nvar initialState = {\n  type: \"\",\n  viewportWidth: 0,\n  viewportHeight: 0\n};\n\nfunction resolveAdaptivity(data) {\n  var adaptivity = data.adaptivity,\n      viewport_width = data.viewport_width,\n      viewport_height = data.viewport_height;\n  var bridgeAdaptivity = {\n    type: \"\",\n    viewportWidth: isFinite(viewport_width) ? Number(viewport_width) : 0,\n    viewportHeight: isFinite(viewport_height) ? Number(viewport_height) : 0\n  };\n\n  switch (adaptivity) {\n    case \"force_mobile\":\n    case \"force_mobile_compact\":\n    case \"adaptive\":\n      bridgeAdaptivity.type = adaptivity;\n  }\n\n  return bridgeAdaptivity;\n}\n/**\n * TODO [>=6]: удалить хук (#5049)\n * @deprecated v5.8.0\n */\n\n\nexport function useBridgeAdaptivity() {\n  var disable = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : false;\n\n  var _React_useState = _sliced_to_array(React.useState(initialState), 2),\n      bridgeAdaptivity = _React_useState[0],\n      setBridgeAdaptivity = _React_useState[1];\n\n  useIsomorphicLayoutEffect(function () {\n    if (disable) {\n      return;\n    }\n\n    var updateAdaptivity = function (data) {\n      if (!(\"adaptivity\" in data) || !(\"viewport_width\" in data) || !(\"viewport_height\" in data)) {\n        return;\n      }\n\n      var newAdaptivity = resolveAdaptivity(data);\n\n      if (newAdaptivity) {\n        setBridgeAdaptivity(newAdaptivity);\n      }\n    };\n\n    var handleBridgeEvent = function (event) {\n      var _event_detail = event.detail,\n          type = _event_detail.type,\n          data = _event_detail.data;\n\n      if (type !== \"VKWebAppUpdateConfig\") {\n        return;\n      }\n\n      updateAdaptivity(data);\n    };\n\n    vkBridge.subscribe(handleBridgeEvent);\n    vkBridge.send(\"VKWebAppGetConfig\").then(updateAdaptivity).catch(console.error);\n    return function () {\n      vkBridge.unsubscribe(handleBridgeEvent);\n    };\n  }, []);\n  return bridgeAdaptivity;\n}","map":{"version":3,"mappings":";AAAA,YAAYA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,SAASC,yBAAT,QAA0C,kCAA1C;AAiBA,IAAIC,eAAiC;EACnCC,MAAM,EAD6B;EAEnCC,eAAe,CAFoB;EAGnCC,gBAAgB;AAHmB,CAArC;;AAMA,SAASC,iBAAT,CAA2BC,IAA3B,EAAoC;EAClC,IAAQC,aAAgDD,KAAhDC,UAAR;EAAA,IAAoBC,iBAAoCF,KAApCE,cAApB;EAAA,IAAoCC,kBAAoBH,KAApBG,eAApC;EAEA,IAAMC,mBAAqC;IACzCR,MAAM,EADmC;IAEzCC,eAAeQ,SAASH,cAATG,IAA2BC,OAAOJ,cAAPI,CAA3BD,GAAoD,CAF1B;IAGzCP,gBAAgBO,SAASF,eAATE,IAA4BC,OAAOH,eAAPG,CAA5BD,GAAsD;EAH7B,CAA3C;;EAMA,QAAQJ,UAAR;IACE,KAAK,cAAL;IACA,KAAK,sBAAL;IACA,KAAK,UAAL;MACEG,iBAAiBR,IAAjBQ,GAAwBH,UAAxBG;EAJJ;;EAOA,OAAOA,gBAAP;AACF;AAEA;;;;;;AAIA,OAAO,SAASG,mBAAT,GAASA;MAAoBC,2EAAU;;EAC5C,IAAgDhB,yCAAMiB,QAANjB,CAAiCG,YAAjCH,GAAiCG,CAAjCH,CAAhD;EAAA,IAAOY,mBAAyCZ,kBAAhD;EAAA,IAAyBkB,sBAAuBlB,kBAAhD;;EAEAE,0BAA0B;IACxB,IAAIc,OAAJ,EAAa;MACX;IACF;;IAEA,IAAMG,mBAAmB,UAACX,IAAD,EAACA;MACxB,IAAI,EAAE,gBAAgBA,IAAlB,KAA2B,EAAE,oBAAoBA,IAAtB,CAA3B,IAA0D,EAAE,qBAAqBA,IAAvB,CAA9D,EAA4F;QAC1F;MACF;;MAEA,IAAMY,gBAAgBb,kBAAkBC,IAAlBD,CAAtB;;MAEA,IAAIa,aAAJ,EAAmB;QACjBF,oBAAoBE,aAApBF;MACF;IACF,CAVA;;IAYA,IAAMG,oBAAoB,UAACC,KAAD,EAACA;MACzB,IAAuBA,sBAAMC,MAA7B;MAAA,IAAQnB,OAAekB,cAAflB,IAAR;MAAA,IAAcI,OAASc,cAATd,IAAd;;MAEA,IAAIJ,SAAS,sBAAb,EAAqC;QACnC;MACF;;MAEAe,iBAAiBX,IAAjBW;IACF,CARA;;IAUAlB,SAASuB,SAATvB,CAAmBoB,iBAAnBpB;IACAA,SAASwB,IAATxB,CAAc,mBAAdA,EAAmCyB,IAAnCzB,CAAwCkB,gBAAxClB,EAA0D0B,KAA1D1B,CAAgE2B,QAAQC,KAAxE5B;IAEA,OAAO;MACLA,SAAS6B,WAAT7B,CAAqBoB,iBAArBpB;IACF,CAFA;EAGF,CAjCAC,EAiCG,EAjCHA;EAmCA,OAAOU,gBAAP;AACF","names":["React","vkBridge","useIsomorphicLayoutEffect","initialState","type","viewportWidth","viewportHeight","resolveAdaptivity","data","adaptivity","viewport_width","viewport_height","bridgeAdaptivity","isFinite","Number","useBridgeAdaptivity","disable","useState","setBridgeAdaptivity","updateAdaptivity","newAdaptivity","handleBridgeEvent","event","detail","subscribe","send","then","catch","console","error","unsubscribe"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkui\\src\\hooks\\useBridgeAdaptivity.ts"],"sourcesContent":["import * as React from 'react';\nimport vkBridge from '@vkontakte/vk-bridge';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\nexport interface BridgeAdaptivity {\n  type: '' | 'force_mobile' | 'force_mobile_compact' | 'adaptive';\n  viewportWidth: number;\n  viewportHeight: number;\n}\n\ninterface BridgeEvent {\n  detail: {\n    type: string;\n    data: {\n      [index: string]: any;\n    };\n  };\n}\n\nlet initialState: BridgeAdaptivity = {\n  type: '',\n  viewportWidth: 0,\n  viewportHeight: 0,\n};\n\nfunction resolveAdaptivity(data: any): BridgeAdaptivity | null {\n  const { adaptivity, viewport_width, viewport_height } = data;\n\n  const bridgeAdaptivity: BridgeAdaptivity = {\n    type: '',\n    viewportWidth: isFinite(viewport_width) ? Number(viewport_width) : 0,\n    viewportHeight: isFinite(viewport_height) ? Number(viewport_height) : 0,\n  };\n\n  switch (adaptivity) {\n    case 'force_mobile':\n    case 'force_mobile_compact':\n    case 'adaptive':\n      bridgeAdaptivity.type = adaptivity;\n  }\n\n  return bridgeAdaptivity;\n}\n\n/**\n * TODO [>=6]: удалить хук (#5049)\n * @deprecated v5.8.0\n */\nexport function useBridgeAdaptivity(disable = false): BridgeAdaptivity {\n  const [bridgeAdaptivity, setBridgeAdaptivity] = React.useState<BridgeAdaptivity>(initialState);\n\n  useIsomorphicLayoutEffect(() => {\n    if (disable) {\n      return;\n    }\n\n    const updateAdaptivity = (data: any) => {\n      if (!('adaptivity' in data) || !('viewport_width' in data) || !('viewport_height' in data)) {\n        return;\n      }\n\n      const newAdaptivity = resolveAdaptivity(data);\n\n      if (newAdaptivity) {\n        setBridgeAdaptivity(newAdaptivity);\n      }\n    };\n\n    const handleBridgeEvent = (event: BridgeEvent) => {\n      const { type, data } = event.detail;\n\n      if (type !== 'VKWebAppUpdateConfig') {\n        return;\n      }\n\n      updateAdaptivity(data);\n    };\n\n    vkBridge.subscribe(handleBridgeEvent);\n    vkBridge.send('VKWebAppGetConfig').then(updateAdaptivity).catch(console.error);\n\n    return () => {\n      vkBridge.unsubscribe(handleBridgeEvent);\n    };\n  }, []);\n\n  return bridgeAdaptivity;\n}\n"]},"metadata":{},"sourceType":"module"}