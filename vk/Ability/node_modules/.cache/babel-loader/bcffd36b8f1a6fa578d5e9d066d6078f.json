{"ast":null,"code":"import * as React from \"react\";\nimport { noop } from \"@vkontakte/vkjs\";\nimport { useDOM } from \"../lib/dom\";\nimport { transitionEvent } from \"../lib/supportEvents\";\nexport var useWaitTransitionFinish = function () {\n  var timeoutRef = React.useRef(null);\n  var document = useDOM().document;\n  var detach = React.useRef(noop);\n  var remove = React.useCallback(function () {\n    detach.current();\n    detach.current = noop;\n  }, []);\n  var waitTransitionFinish = React.useCallback(function (element, eventHandler, durationFallback) {\n    if (element) {\n      if (!(document === null || document === void 0 ? void 0 : document.hidden) && transitionEvent.supported && transitionEvent.name) {\n        remove();\n        element.addEventListener(transitionEvent.name, eventHandler);\n\n        detach.current = function () {\n          if (transitionEvent.name) {\n            element.removeEventListener(transitionEvent.name, eventHandler);\n          }\n        };\n      } else {\n        if (timeoutRef === null || timeoutRef === void 0 ? void 0 : timeoutRef.current) {\n          clearTimeout(timeoutRef.current);\n        }\n\n        timeoutRef.current = setTimeout(eventHandler, durationFallback);\n      }\n    }\n  }, [document, remove, timeoutRef]);\n  return {\n    waitTransitionFinish: waitTransitionFinish\n  };\n};","map":{"version":3,"mappings":"AAAA,YAAYA,KAAZ,MAAuB,OAAvB;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,SAASC,MAAT,QAAuB,YAAvB;AACA,SAASC,eAAT,QAAgC,sBAAhC;AAEA,OAAO,IAAMC,0BAA0B;EACrC,IAAMC,aAAaL,MAAMM,MAANN,CAAmD,IAAnDA,CAAnB;EACA,IAAMO,QAAEA,GAAaL,SAAbK,QAAR;EACA,IAAMC,SAASR,MAAMM,MAANN,CAAaC,IAAbD,CAAf;EAEA,IAAMS,SAAST,MAAMU,WAANV,CAAkB;IAC/BQ,OAAOG,OAAPH;IACAA,OAAOG,OAAPH,GAAiBP,IAAjBO;EACF,CAHeR,EAGZ,EAHYA,CAAf;EAKA,IAAMY,uBAAuBZ,MAAMU,WAANV,CAC3B,UACEa,OADF,EAEEC,YAFF,EAGEC,gBAHF,EAGEA;IAEA,IAAIF,OAAJ,EAAa;MACX,IAAI,EAACN,6DAAUS,MAAX,KAAqBb,gBAAgBc,SAArC,IAAkDd,gBAAgBe,IAAtE,EAA4E;QAC1ET;QACAI,QAAQM,gBAARN,CAAyBV,gBAAgBe,IAAzCL,EAA+CC,YAA/CD;;QACAL,OAAOG,OAAPH,GAAiB;UACf,IAAIL,gBAAgBe,IAApB,EAA0B;YACxBL,QAAQO,mBAARP,CAA4BV,gBAAgBe,IAA5CL,EAAkDC,YAAlDD;UACF;QACF,CAJAL;MAKF,CARA,MAQO;QACL,IAAIH,mEAAYM,OAAhB,EAAyB;UACvBU,aAAahB,WAAWM,OAAxBU;QACF;;QACAhB,WAAWM,OAAXN,GAAqBiB,WAAWR,YAAXQ,EAAyBP,gBAAzBO,CAArBjB;MACF;IACF;EACF,CAtB2BL,EAuB3B,CAACO,QAAD,EAAWE,MAAX,EAAmBJ,UAAnB,CAvB2BL,CAA7B;EA0BA,OAAO;IACLY;EADK,CAAP;AAGF,CAvCO","names":["React","noop","useDOM","transitionEvent","useWaitTransitionFinish","timeoutRef","useRef","document","detach","remove","useCallback","current","waitTransitionFinish","element","eventHandler","durationFallback","hidden","supported","name","addEventListener","removeEventListener","clearTimeout","setTimeout"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkui\\src\\hooks\\useWaitTransitionFinish.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { useDOM } from '../lib/dom';\nimport { transitionEvent } from '../lib/supportEvents';\n\nexport const useWaitTransitionFinish = () => {\n  const timeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n  const { document } = useDOM();\n  const detach = React.useRef(noop);\n\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n\n  const waitTransitionFinish = React.useCallback(\n    (\n      element: HTMLElement | undefined | null,\n      eventHandler: VoidFunction,\n      durationFallback: number,\n    ) => {\n      if (element) {\n        if (!document?.hidden && transitionEvent.supported && transitionEvent.name) {\n          remove();\n          element.addEventListener(transitionEvent.name, eventHandler);\n          detach.current = () => {\n            if (transitionEvent.name) {\n              element.removeEventListener(transitionEvent.name, eventHandler);\n            }\n          };\n        } else {\n          if (timeoutRef?.current) {\n            clearTimeout(timeoutRef.current);\n          }\n          timeoutRef.current = setTimeout(eventHandler, durationFallback);\n        }\n      }\n    },\n    [document, remove, timeoutRef],\n  );\n\n  return {\n    waitTransitionFinish,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}