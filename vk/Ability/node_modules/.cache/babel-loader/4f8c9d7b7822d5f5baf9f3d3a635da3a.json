{"ast":null,"code":"import { _ as _class_call_check } from \"@swc/helpers/_/_class_call_check\";\nimport { _ as _create_class } from \"@swc/helpers/_/_create_class\";\nimport { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nimport { _ as _instanceof } from \"@swc/helpers/_/_instanceof\";\n\nvar CustomStorage = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function CustomStorage() {\n    var _this = this;\n\n    _class_call_check(this, CustomStorage);\n\n    _define_property(this, \"data\", {});\n\n    _define_property(this, \"getItem\", function (key) {\n      return _this.data.hasOwnProperty(key) ? _this.data[key] : null;\n    });\n\n    _define_property(this, \"keys\", function () {\n      return Object.keys(_this.data);\n    });\n  }\n\n  _create_class(CustomStorage, [{\n    key: \"setItem\",\n    value: function setItem(key, val) {\n      this.data[key] = String(val);\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(id) {\n      delete this.data[id];\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.data = {};\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return Object.keys(this.data).length;\n    }\n  }, {\n    key: \"key\",\n    value: function key(index) {\n      return Object.keys(this.data)[index];\n    }\n  }]);\n\n  return CustomStorage;\n}();\n\nvar dummyKey = \"vk-ls-dummy\";\nvar dummyContent = \"test\";\nvar ls;\n\nfunction getLocalStorage() {\n  if (ls) {\n    return ls;\n  }\n\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.localStorage.setItem(dummyKey, dummyContent);\n\n    if (dummyContent !== window.localStorage.getItem(dummyKey)) {\n      throw new Error(\"localStorage is broken\");\n    }\n\n    window.localStorage.removeItem(dummyKey);\n    ls = window.localStorage;\n  } catch (e) {\n    ls = new CustomStorage();\n  }\n\n  return ls;\n}\n/**\n * Обертка над localStorage для кода, который может использоваться на других сайтах\n * Firefox блокирует доступ к localStorage для скриптов с других доменов\n */\n\n\nexport var localStorage = {\n  setItem: function (key, val) {\n    return getLocalStorage().setItem(key, val);\n  },\n  getItem: function (key) {\n    return getLocalStorage().getItem(key);\n  },\n  removeItem: function (key) {\n    return getLocalStorage().removeItem(key);\n  },\n  clear: function () {\n    return getLocalStorage().clear();\n  },\n  length: function () {\n    return getLocalStorage().length;\n  },\n  key: function (index) {\n    return getLocalStorage().key(index);\n  },\n  keys: function keys() {\n    var storage = getLocalStorage();\n\n    if (_instanceof(storage, CustomStorage)) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: function (prefix) {\n    return localStorage.keys().filter(function (key) {\n      return key.startsWith(prefix);\n    });\n  }\n};\nvar sessionStorageCache;\n\nfunction getSessionStorage() {\n  if (sessionStorageCache) {\n    return sessionStorageCache;\n  }\n\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.sessionStorage.setItem(dummyKey, dummyContent);\n\n    if (dummyContent !== window.sessionStorage.getItem(dummyKey)) {\n      throw new Error(\"sessionStorage is broken\");\n    }\n\n    window.sessionStorage.removeItem(dummyKey);\n    sessionStorageCache = window.sessionStorage;\n  } catch (e) {\n    sessionStorageCache = new CustomStorage();\n  }\n\n  return sessionStorageCache;\n}\n\nexport var sessionStorage = {\n  setItem: function (key, val) {\n    return getSessionStorage().setItem(key, val);\n  },\n  getItem: function (key) {\n    return getSessionStorage().getItem(key);\n  },\n  removeItem: function (key) {\n    return getSessionStorage().removeItem(key);\n  },\n  clear: function () {\n    return getSessionStorage().clear();\n  },\n  length: function () {\n    return getSessionStorage().length;\n  },\n  key: function (index) {\n    return getSessionStorage().key(index);\n  },\n  keys: function keys() {\n    var storage = getSessionStorage();\n\n    if (_instanceof(storage, CustomStorage)) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: function (prefix) {\n    return sessionStorage.keys().filter(function (key) {\n      return key.startsWith(prefix);\n    });\n  }\n};","map":{"version":3,"mappings":"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","names":["CustomStorage","_define_property","data","getItem","key","_this","hasOwnProperty","keys","Object","setItem","val","String","removeItem","id","clear","length","index","dummyKey","dummyContent","ls","getLocalStorage","window","localStorage","Error","e","storage","getPrefixedKeys","prefix","filter","startsWith","sessionStorageCache","getSessionStorage","sessionStorage"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkjs\\src\\storage.ts"],"sourcesContent":["import { Dictionary } from './types';\n\nclass CustomStorage {\n  private data: Dictionary<string> = {};\n\n  public setItem(key: string, val: string) {\n    this.data[key] = String(val);\n  }\n\n  public getItem = (key: string) => (this.data.hasOwnProperty(key) ? this.data[key] : null);\n\n  public removeItem(id: string) {\n    delete this.data[id];\n  }\n\n  public clear() {\n    this.data = {};\n  }\n\n  public get length() {\n    return Object.keys(this.data).length;\n  }\n\n  public key(index: number): string | null {\n    return Object.keys(this.data)[index];\n  }\n\n  public keys = (): string[] => Object.keys(this.data);\n}\n\nconst dummyKey = 'vk-ls-dummy';\nconst dummyContent = 'test';\n\nlet ls: CustomStorage | Storage;\n\nfunction getLocalStorage() {\n  if (ls) {\n    return ls;\n  }\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.localStorage.setItem(dummyKey, dummyContent);\n    if (dummyContent !== window.localStorage.getItem(dummyKey)) {\n      throw new Error('localStorage is broken');\n    }\n    window.localStorage.removeItem(dummyKey);\n    ls = window.localStorage;\n  } catch (e) {\n    ls = new CustomStorage();\n  }\n  return ls;\n}\n\n/**\n * Обертка над localStorage для кода, который может использоваться на других сайтах\n * Firefox блокирует доступ к localStorage для скриптов с других доменов\n */\nexport const localStorage = {\n  setItem: (key: string, val: string) => getLocalStorage().setItem(key, val),\n  getItem: (key: string) => getLocalStorage().getItem(key),\n  removeItem: (key: string) => getLocalStorage().removeItem(key),\n  clear: () => getLocalStorage().clear(),\n  length: () => getLocalStorage().length,\n  key: (index: number) => getLocalStorage().key(index),\n  keys(): string[] {\n    const storage = getLocalStorage();\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: (prefix: string): string[] => {\n    return localStorage.keys().filter((key) => key.startsWith(prefix));\n  },\n};\n\nlet sessionStorageCache: CustomStorage | Storage;\n\nfunction getSessionStorage() {\n  if (sessionStorageCache) {\n    return sessionStorageCache;\n  }\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.sessionStorage.setItem(dummyKey, dummyContent);\n    if (dummyContent !== window.sessionStorage.getItem(dummyKey)) {\n      throw new Error('sessionStorage is broken');\n    }\n    window.sessionStorage.removeItem(dummyKey);\n    sessionStorageCache = window.sessionStorage;\n  } catch (e) {\n    sessionStorageCache = new CustomStorage();\n  }\n  return sessionStorageCache;\n}\n\nexport const sessionStorage = {\n  setItem: (key: string, val: string) => getSessionStorage().setItem(key, val),\n  getItem: (key: string) => getSessionStorage().getItem(key),\n  removeItem: (key: string) => getSessionStorage().removeItem(key),\n  clear: () => getSessionStorage().clear(),\n  length: () => getSessionStorage().length,\n  key: (index: number) => getSessionStorage().key(index),\n  keys(): string[] {\n    const storage = getSessionStorage();\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: (prefix: string): string[] => {\n    return sessionStorage.keys().filter((key) => key.startsWith(prefix));\n  },\n};\n"]},"metadata":{},"sourceType":"module"}