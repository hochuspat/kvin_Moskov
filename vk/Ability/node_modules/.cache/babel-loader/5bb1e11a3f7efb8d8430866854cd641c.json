{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { noop } from \"@vkontakte/vkjs\";\nimport { useAdaptivityWithJSMediaQueries } from \"../../hooks/useAdaptivityWithJSMediaQueries\";\nimport { useObjectMemo } from \"../../hooks/useObjectMemo\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport { Platform } from \"../../lib/platform\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { useScrollLock } from \"../AppRoot/ScrollContext\";\nimport { PopoutWrapper } from \"../PopoutWrapper/PopoutWrapper\";\nimport { Footnote } from \"../Typography/Footnote/Footnote\";\nimport { ActionSheetContext } from \"./ActionSheetContext\";\nimport { ActionSheetDefaultIosCloseItem } from \"./ActionSheetDefaultIosCloseItem\";\nimport { ActionSheetDropdownMenu } from \"./ActionSheetDropdownMenu\";\nimport { ActionSheetDropdownSheet } from \"./ActionSheetDropdownSheet\";\nvar warn = warnOnce(\"ActionSheet\");\n/**\n * @see https://vkcom.github.io/VKUI/#/ActionSheet\n */\n\nexport var ActionSheet = function (_param) {\n  var children = _param.children,\n      className = _param.className,\n      header = _param.header,\n      text = _param.text,\n      style = _param.style,\n      iosCloseItem = _param.iosCloseItem,\n      popupDirection = _param.popupDirection,\n      popupOffsetDistance = _param.popupOffsetDistance,\n      placement = _param.placement,\n      modeProp = _param.mode,\n      restProps = _object_without_properties(_param, [\"children\", \"className\", \"header\", \"text\", \"style\", \"iosCloseItem\", \"popupDirection\", \"popupOffsetDistance\", \"placement\", \"mode\"]);\n\n  var platform = usePlatform();\n\n  var _React_useState = _sliced_to_array(React.useState(undefined), 2),\n      closingBy = _React_useState[0],\n      setClosingBy = _React_useState[1];\n\n  var onClose = function () {\n    return setClosingBy(\"other\");\n  };\n\n  var _action = React.useRef(noop);\n\n  var afterClose = function () {\n    restProps.onClose({\n      closedBy: closingBy || \"other\"\n    });\n\n    _action.current();\n\n    _action.current = noop;\n  };\n\n  var isDesktop = useAdaptivityWithJSMediaQueries().isDesktop;\n  var mode = modeProp !== null && modeProp !== void 0 ? modeProp : isDesktop ? \"menu\" : \"sheet\";\n  useScrollLock(mode === \"sheet\");\n  var timeout = platform === Platform.IOS ? 300 : 200;\n\n  if (mode === \"menu\") {\n    timeout = 0;\n  }\n\n  var fallbackTransitionFinish = useTimeout(afterClose, timeout);\n  React.useEffect(function () {\n    if (closingBy) {\n      fallbackTransitionFinish.set();\n    } else {\n      fallbackTransitionFinish.clear();\n    }\n  }, [closingBy, fallbackTransitionFinish]);\n  var onItemClick = React.useCallback(function (param) {\n    var action = param.action,\n        immediateAction = param.immediateAction,\n        autoClose = param.autoClose,\n        isCancelItem = param.isCancelItem;\n    return function (event) {\n      event.persist();\n      immediateAction && immediateAction(event);\n\n      if (autoClose) {\n        _action.current = function () {\n          return action && action(event);\n        };\n\n        setClosingBy(isCancelItem ? \"cancel-item\" : \"action-item\");\n      } else {\n        action && action(event);\n      }\n    };\n  }, []);\n  var contextValue = useObjectMemo({\n    onItemClick: onItemClick,\n    mode: mode\n  });\n  var DropdownComponent = mode === \"menu\" ? ActionSheetDropdownMenu : ActionSheetDropdownSheet;\n\n  if (process.env.NODE_ENV === \"development\" && popupDirection) {\n    // TODO [>=6]: popupDirection\n    warn('Свойство \"popupDirection\" будет удалено в v6. Используйте свойство \"placement\"');\n  }\n\n  popupDirection = popupDirection !== undefined ? popupDirection : \"bottom\";\n  var dropdownProps = mode === \"menu\" ? Object.assign(restProps, {\n    popupOffsetDistance: popupOffsetDistance,\n    popupDirection: popupDirection,\n    placement: placement\n  }) : restProps;\n  var actionSheet = /*#__PURE__*/React.createElement(ActionSheetContext.Provider, {\n    value: contextValue\n  }, /*#__PURE__*/React.createElement(DropdownComponent, _object_spread_props(_object_spread({\n    closing: Boolean(closingBy),\n    timeout: timeout\n  }, dropdownProps), {\n    onClose: onClose,\n    className: mode === \"menu\" ? className : undefined,\n    style: mode === \"menu\" ? style : undefined\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiActionSheet__content-wrapper\"\n  }, (header || text) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiActionSheet__header\"\n  }, header && /*#__PURE__*/React.createElement(Footnote, {\n    weight: \"2\",\n    className: \"vkuiActionSheet__title\"\n  }, header), text && /*#__PURE__*/React.createElement(Footnote, {\n    className: \"vkuiActionSheet__text\"\n  }, text)), children), platform === Platform.IOS && mode === \"sheet\" && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiActionSheet__close-item-wrapper--ios\"\n  }, iosCloseItem !== null && iosCloseItem !== void 0 ? iosCloseItem : /*#__PURE__*/React.createElement(ActionSheetDefaultIosCloseItem, null))));\n\n  if (mode === \"menu\") {\n    return actionSheet;\n  }\n\n  return /*#__PURE__*/React.createElement(PopoutWrapper, {\n    closing: Boolean(closingBy),\n    alignY: \"bottom\",\n    className: className,\n    style: style,\n    onClick: onClose,\n    hasMask: true,\n    fixed: true\n  }, actionSheet);\n};","map":{"version":3,"mappings":"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","names":["React","noop","useAdaptivityWithJSMediaQueries","useObjectMemo","usePlatform","useTimeout","Platform","warnOnce","useScrollLock","PopoutWrapper","Footnote","ActionSheetContext","ActionSheetDefaultIosCloseItem","ActionSheetDropdownMenu","ActionSheetDropdownSheet","warn","ActionSheet","children","className","header","text","style","iosCloseItem","popupDirection","popupOffsetDistance","placement","mode","modeProp","restProps","platform","useState","undefined","closingBy","setClosingBy","onClose","_action","useRef","afterClose","closedBy","current","isDesktop","timeout","IOS","fallbackTransitionFinish","useEffect","set","clear","onItemClick","useCallback","action","immediateAction","autoClose","isCancelItem","event","persist","contextValue","DropdownComponent","process","env","NODE_ENV","dropdownProps","Object","assign","actionSheet","Provider","value","closing","Boolean","div","weight","alignY","onClick","hasMask","fixed"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkui\\src\\components\\ActionSheet\\ActionSheet.tsx"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { useAdaptivityWithJSMediaQueries } from '../../hooks/useAdaptivityWithJSMediaQueries';\nimport { useObjectMemo } from '../../hooks/useObjectMemo';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { Platform } from '../../lib/platform';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { PopoutWrapper } from '../PopoutWrapper/PopoutWrapper';\nimport { Footnote } from '../Typography/Footnote/Footnote';\nimport { ActionSheetContext, ItemClickHandler } from './ActionSheetContext';\nimport { ActionSheetDefaultIosCloseItem } from './ActionSheetDefaultIosCloseItem';\nimport { ActionSheetDropdownMenu } from './ActionSheetDropdownMenu';\nimport { ActionSheetDropdownSheet } from './ActionSheetDropdownSheet';\nimport { SharedDropdownProps } from './types';\nimport styles from './ActionSheet.module.css';\n\nconst warn = warnOnce('ActionSheet');\ntype CloseInitiators = 'action-item' | 'cancel-item' | 'other';\nexport interface ActionSheetOnCloseOptions {\n  closedBy: CloseInitiators;\n}\n\nexport interface ActionSheetProps\n  extends Pick<\n      SharedDropdownProps,\n      'toggleRef' | 'popupDirection' | 'popupOffsetDistance' | 'placement'\n    >,\n    React.HTMLAttributes<HTMLDivElement> {\n  header?: React.ReactNode;\n  text?: React.ReactNode;\n  /**\n   * Закрыть попап по клику снаружи.\n   */\n  onClose(options: ActionSheetOnCloseOptions): void;\n  /**\n   * Только мобильный iOS.\n   */\n  iosCloseItem?: React.ReactNode;\n  mode?: 'sheet' | 'menu';\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/ActionSheet\n */\nexport const ActionSheet = ({\n  children,\n  className,\n  header,\n  text,\n  style,\n  iosCloseItem,\n  popupDirection,\n  popupOffsetDistance,\n  placement,\n  mode: modeProp,\n  ...restProps\n}: ActionSheetProps) => {\n  const platform = usePlatform();\n  const [closingBy, setClosingBy] = React.useState<undefined | CloseInitiators>(undefined);\n  const onClose = () => setClosingBy('other');\n  const _action = React.useRef(noop);\n\n  const afterClose = () => {\n    restProps.onClose({ closedBy: closingBy || 'other' });\n    _action.current();\n    _action.current = noop;\n  };\n\n  const { isDesktop } = useAdaptivityWithJSMediaQueries();\n  const mode = modeProp ?? (isDesktop ? 'menu' : 'sheet');\n\n  useScrollLock(mode === 'sheet');\n\n  let timeout = platform === Platform.IOS ? 300 : 200;\n\n  if (mode === 'menu') {\n    timeout = 0;\n  }\n\n  const fallbackTransitionFinish = useTimeout(afterClose, timeout);\n  React.useEffect(() => {\n    if (closingBy) {\n      fallbackTransitionFinish.set();\n    } else {\n      fallbackTransitionFinish.clear();\n    }\n  }, [closingBy, fallbackTransitionFinish]);\n\n  const onItemClick = React.useCallback<ItemClickHandler>(\n    ({ action, immediateAction, autoClose, isCancelItem }) =>\n      (event) => {\n        event.persist();\n        immediateAction && immediateAction(event);\n        if (autoClose) {\n          _action.current = () => action && action(event);\n          setClosingBy(isCancelItem ? 'cancel-item' : 'action-item');\n        } else {\n          action && action(event);\n        }\n      },\n    [],\n  );\n  const contextValue = useObjectMemo({ onItemClick, mode });\n\n  const DropdownComponent = mode === 'menu' ? ActionSheetDropdownMenu : ActionSheetDropdownSheet;\n\n  if (process.env.NODE_ENV === 'development' && popupDirection) {\n    // TODO [>=6]: popupDirection\n    warn('Свойство \"popupDirection\" будет удалено в v6. Используйте свойство \"placement\"');\n  }\n\n  popupDirection = popupDirection !== undefined ? popupDirection : 'bottom';\n\n  const dropdownProps =\n    mode === 'menu'\n      ? Object.assign(restProps, { popupOffsetDistance, popupDirection, placement })\n      : restProps;\n\n  const actionSheet = (\n    <ActionSheetContext.Provider value={contextValue}>\n      <DropdownComponent\n        closing={Boolean(closingBy)}\n        timeout={timeout}\n        {...dropdownProps}\n        onClose={onClose}\n        className={mode === 'menu' ? className : undefined}\n        style={mode === 'menu' ? style : undefined}\n      >\n        <div className={styles['ActionSheet__content-wrapper']}>\n          {(header || text) && (\n            <div className={styles['ActionSheet__header']}>\n              {header && (\n                <Footnote weight=\"2\" className={styles['ActionSheet__title']}>\n                  {header}\n                </Footnote>\n              )}\n              {text && <Footnote className={styles['ActionSheet__text']}>{text}</Footnote>}\n            </div>\n          )}\n          {children}\n        </div>\n        {platform === Platform.IOS && mode === 'sheet' && (\n          <div className={styles['ActionSheet__close-item-wrapper--ios']}>\n            {iosCloseItem ?? <ActionSheetDefaultIosCloseItem />}\n          </div>\n        )}\n      </DropdownComponent>\n    </ActionSheetContext.Provider>\n  );\n\n  if (mode === 'menu') {\n    return actionSheet;\n  }\n\n  return (\n    <PopoutWrapper\n      closing={Boolean(closingBy)}\n      alignY=\"bottom\"\n      className={className}\n      style={style}\n      onClick={onClose}\n      hasMask\n      fixed\n    >\n      {actionSheet}\n    </PopoutWrapper>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}