{"ast":null,"code":"import { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nimport { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport { SizeType } from \"../../lib/adaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { Platform } from \"../../lib/platform\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { useScrollLock } from \"../AppRoot/ScrollContext\";\nimport { FixedLayout } from \"../FixedLayout/FixedLayout\";\n\nvar _obj;\n\nvar sizeXClassNames = (_obj = {\n  none: \"vkuiPanelHeaderContext--sizeX-none\"\n}, _define_property(_obj, SizeType.COMPACT, \"vkuiPanelHeaderContext--sizeX-compact\"), _define_property(_obj, SizeType.REGULAR, \"vkuiPanelHeaderContext--sizeX-regular\"), _obj);\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\n\nexport var PanelHeaderContext = function (_param) {\n  var children = _param.children,\n      onClose = _param.onClose,\n      _param_opened = _param.opened,\n      opened = _param_opened === void 0 ? false : _param_opened,\n      className = _param.className,\n      restProps = _object_without_properties(_param, [\"children\", \"onClose\", \"opened\", \"className\"]);\n\n  var document = useDOM().document;\n  var platform = usePlatform();\n\n  var _React_useState = _sliced_to_array(React.useState(opened), 2),\n      visible = _React_useState[0],\n      setVisible = _React_useState[1];\n\n  var closing = visible && !opened;\n\n  var _useAdaptivity = useAdaptivity(),\n      _useAdaptivity_sizeX = _useAdaptivity.sizeX,\n      sizeX = _useAdaptivity_sizeX === void 0 ? \"none\" : _useAdaptivity_sizeX;\n\n  var elementRef = React.useRef(null);\n  useIsomorphicLayoutEffect(function () {\n    opened && setVisible(true);\n  }, [opened]);\n  useScrollLock(platform !== Platform.VKCOM && opened); // start closing on outer click\n\n  useGlobalEventListener(document, \"click\", opened && !closing && function (event) {\n    if (elementRef.current && !elementRef.current.contains(event.target)) {\n      event.stopPropagation();\n      onClose();\n    }\n  }, {\n    capture: true\n  }); // fallback onAnimationEnd when animationend not supported\n\n  var onAnimationEnd = function () {\n    return setVisible(false);\n  };\n\n  var animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(function () {\n    return closing ? animationFallback.set() : animationFallback.clear();\n  }, [animationFallback, closing]);\n  return /*#__PURE__*/React.createElement(FixedLayout, _object_spread_props(_object_spread({}, restProps), {\n    className: classNames(\"vkuiPanelHeaderContext\", platform === Platform.IOS && \"vkuiPanelHeaderContext--ios\", opened && \"vkuiPanelHeaderContext--opened\", closing && \"vkuiPanelHeaderContext--closing\", sizeXClassNames[sizeX], className),\n    vertical: \"top\"\n  }), visible && /*#__PURE__*/React.createElement(\"div\", {\n    onClick: function (event) {\n      event.stopPropagation();\n      onClose();\n    },\n    className: \"vkuiPanelHeaderContext__fade\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__in\",\n    ref: elementRef,\n    onAnimationEnd: closing ? onAnimationEnd : undefined\n  }, visible && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__content\"\n  }, children)));\n};","map":{"version":3,"mappings":"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","names":["React","classNames","useAdaptivity","useGlobalEventListener","usePlatform","useTimeout","SizeType","useDOM","Platform","useIsomorphicLayoutEffect","useScrollLock","FixedLayout","_obj","sizeXClassNames","none","COMPACT","_define_property","REGULAR","PanelHeaderContext","children","onClose","opened","_param_opened","className","restProps","document","platform","useState","visible","setVisible","closing","sizeX","_useAdaptivity_sizeX","elementRef","useRef","VKCOM","event","current","contains","target","stopPropagation","capture","onAnimationEnd","animationFallback","useEffect","set","clear","IOS","vertical","div","onClick","ref","undefined"],"sources":["C:\\Users\\kulag\\vk\\Ability\\node_modules\\@vkontakte\\vkui\\src\\components\\PanelHeaderContext\\PanelHeaderContext.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { SizeType } from '../../lib/adaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { Platform } from '../../lib/platform';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { HTMLAttributesWithRootRef } from '../../types';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { FixedLayout } from '../FixedLayout/FixedLayout';\nimport styles from './PanelHeaderContext.module.css';\n\nconst sizeXClassNames = {\n  none: styles['PanelHeaderContext--sizeX-none'],\n  [SizeType.COMPACT]: styles['PanelHeaderContext--sizeX-compact'],\n  [SizeType.REGULAR]: styles['PanelHeaderContext--sizeX-regular'],\n};\n\nexport interface PanelHeaderContextProps extends HTMLAttributesWithRootRef<HTMLDivElement> {\n  opened: boolean;\n  onClose: VoidFunction;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\nexport const PanelHeaderContext = ({\n  children,\n  onClose,\n  opened = false,\n  className,\n  ...restProps\n}: PanelHeaderContextProps) => {\n  const { document } = useDOM();\n  const platform = usePlatform();\n  const [visible, setVisible] = React.useState(opened);\n  const closing = visible && !opened;\n  const { sizeX = 'none' } = useAdaptivity();\n  const elementRef = React.useRef<HTMLDivElement>(null);\n\n  useIsomorphicLayoutEffect(() => {\n    opened && setVisible(true);\n  }, [opened]);\n\n  useScrollLock(platform !== Platform.VKCOM && opened);\n\n  // start closing on outer click\n  useGlobalEventListener(\n    document,\n    'click',\n    opened &&\n      !closing &&\n      ((event) => {\n        if (elementRef.current && !elementRef.current.contains(event.target as Node)) {\n          event.stopPropagation();\n          onClose();\n        }\n      }),\n    { capture: true },\n  );\n\n  // fallback onAnimationEnd when animationend not supported\n  const onAnimationEnd = () => setVisible(false);\n  const animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(\n    () => (closing ? animationFallback.set() : animationFallback.clear()),\n    [animationFallback, closing],\n  );\n\n  return (\n    <FixedLayout\n      {...restProps}\n      className={classNames(\n        styles['PanelHeaderContext'],\n        platform === Platform.IOS && styles['PanelHeaderContext--ios'],\n        opened && styles['PanelHeaderContext--opened'],\n        closing && styles['PanelHeaderContext--closing'],\n        sizeXClassNames[sizeX],\n        className,\n      )}\n      vertical=\"top\"\n    >\n      {visible && (\n        <div\n          onClick={(event) => {\n            event.stopPropagation();\n            onClose();\n          }}\n          className={styles['PanelHeaderContext__fade']}\n        />\n      )}\n      <div\n        className={styles['PanelHeaderContext__in']}\n        ref={elementRef}\n        onAnimationEnd={closing ? onAnimationEnd : undefined}\n      >\n        {visible && <div className={styles['PanelHeaderContext__content']}>{children}</div>}\n      </div>\n    </FixedLayout>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}